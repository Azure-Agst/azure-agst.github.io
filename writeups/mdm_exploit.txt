Project:

	LSMDM_PWN (By: Andrew Augustine)


Exploited Files:

	- ipadbackup/System Files/ManagedPreferencesDomain/mobile/com.apple.SystemConfiguration.plist
	- ipadbackup/System Files/SysShared…com.apple.configurationprofiles/Library/ConfigurationProfiles/MDM.plist
	- ipadbackup/System Files/SysShared…com.apple.configurationprofiles/Library/ConfigurationProfiles/CloudConfigurationDetails.plist
	- ipadbackup/System Files/SysShared…com.apple.configurationprofiles/Library/ConfigurationProfiles/profile-[UDID, Redacted].stub 
		- Now obviously it's not gonna say "profile-[UDID, Redacted].stub" exactly. If you have no idea what a UDID is, it's a
		  random string made up of the characters 0-9 and a-f. (More commonly reffered to as 'Hexcode')
		- Another thing. If you're lucky, there might be multiple files that look like that. The one we're looking for should
		  be installed by "com.apple.purplebuddy". You should see this on lines 11-12.

Description:

	Alright. A while ago, on 3/7/16, I decided to create a program that would remove an Mobile Device Management service from an
	iPad, or escalate local permissions. I named off of my school's MDM server: "LightSpeed MDM" or LSMDM for short. I created
	this tool as a proof of concept, and not as one to be used illegally. Although I named it after a functioning and active
	MDM server, I'm not going to use it for illegal purposes, and neither should you. I will not be held responsible for any
	outcomes of anyone who uses this service.


Results:

	MDM services not working/responding, able to be removed


Tools Used:

	- iTunes
	- iBackupBot
	- /usr/bin/mbdbtool (compiled, optional)
	- Pangu 9.3.3 Jailbreak (optional)


Instructions to reproduce:

		I'D RECCOMEND YOU READ EVERYTHING THOROUGHLY BEFORE TRYING THIS YOURSELF OR YOUR IPAD WON'T BOOT

	- Backup the iPad using your preferred backup engine (iTunes, iBackupBot, your own engine)
	- Decrypt the backup and access the files as stated above using mbdbtool or (preferably) iBackupBot
	- Change some of the arrays/booleans to modify permissions
		- To make sure the iPad completely disconnects from the network, change all `CheckInURL`, `ConfigurationURL`, and `ServerURL`
		  strings to something obscure. (i.e. `https://example.com/ios_dispatch/iugcqwc`, `https://google.com`, 
		  `https://ayylmao.com/rekt/`)
		- Change `IsMDMUnremovable`, `IsMandatory`, and `IsSupervised` booleans to false in CloudConfigurationDetails.plist
		- Change `ProfileWasLocked` and `CheckOutWhenRemoved` booleans to false in “profile-[UDID, Redacted].stub”
		- Delete anything between `<plist></plist>` in com.apple.SystemConfiguration.plist
		- (optional) Change 'PayloadDisplayName' string to whatever you want in “profile-[UDID, Redacted].stub”
	- Restore the backup using iTunes [Gross] or iBackupBot [Nicer, Preferred] or your own restore engine [Best]
	- Once Restored, reboot iPad to apply changes (If not done automatically)
	- Go through the SystemConfig.app dialog by tapping “Get Started” and then “Finish?”
	- Your iPad has now been Pwned. :D
	- (Optional) Go into Settings > General > Device Management and delete MDM using iPad passcode as passkey
	- (Optional, ≤ iOS 9.3.3) From there use Cydia Impactor to install NvwaStone_1.1.ipa to jailbreak and install “Apple File 
	  Conduit ’2’” and iFile from apt.saurik.com to access root filesystem and check for leftover files.


Exploits Discovered:

	(I wouldn’t say this is an exploit worthy of money, as it’s really just messing with files, but hey it still works.) 

	- CVE-2016-4655: Andrew Augustine [Not Patched]

Other Resources:

	- Keynote Presentation to the school. Not linked because screw Apple and my intenet connection.
	
	
